var myList=angular.module("myList",["ngRoute"]),routeConfig=function(e){e.when("/daily",{template:"../html/daily.html",controller:"listController"}).when("/notes",{template:"../html/notes.html",controller:"notesController"}).when("/edit",{template:"../html/edit.html",controller:"addController"}).otherwise({template:"../index.html",controller:"todoController"})};function ListObject(e,t,o,n,r,l,i){this.id=e,this.label=t,this.notes=o,this.category=n,this.date=r,this.text=l,this.dateContr=i}function todoController(e,t,o,n,r){t.categoryLegend=r,t.view=0,t.views=["add","daily","notes","edit"],t.storedView=t.view,t.viewTitles=["New Item","Daily Entries","Notes","Edit"],t.items=[],t.location=n,t.$watch("location.search()",function(){t.card=n.search().card},!0),t.changeCard=function(e){n.search("card",e)},t.$watch("items",function(e,o){t.itemCount=t.items.length}),t.selectedItem=void 0,t.selectedItemID=void 0,t.search=!1,t.searchFilter=void 0,t.categoryFilter=void 0,t.dateFilter=void 0,t.dataLoaded=!1,t.activeDays=[],t.itemCount=0,t.addDate=function(e){t.addDateHelper(e,t.activeDays.length-1)},t.addDateHelper=function(e,o){o<0?t.activeDays.splice(0,0,e):t.dayCompare(e,t.activeDays[o])>0?t.activeDays.splice(o+1,0,e):t.dayCompare(e,t.activeDays[o])<0&&t.addDateHelper(e,o-1)},t.dayCompare=function(e,t){return parseInt(e.substring(0,2))>parseInt(t.substring(0,2))?1:parseInt(e.substring(0,2))<parseInt(t.substring(0,2))?-1:parseInt(e.substring(3,5))>parseInt(t.substring(3,5))?1:parseInt(e.substring(3,5))<parseInt(t.substring(3,5))?-1:0},t.api="http://localhost:3000",o.get(t.api+"/readdata").then(function(e){if(e.data){for(var o=e.data,n=0;n<o.length;n++)o[n].date=new Date(o[n].date),t.items.push(new ListObject(o[n].id,o[n].label,o[n].notes,o[n].category,o[n].date,o[n].text,o[n].dateContr)),t.addDate(o[n].dateContr);t.itemCount=t.items.length}})}function headerController(e,t){t.openSearch=function(){t.search=!0},t.cancelSearch=function(){t.search=!1,t.searchFilter=void 0,t.categoryFilter=void 0},t.editItem=function(){t.storedView=t.view,t.view=3;for(var e=0;e<t.items.length;e++)t.items[e].id==t.selectedItemID&&(t.selectedItem=t.items[e])}}function addController(e,t){e.addItem=function(){t.itemCount++,t.selectedItemID=t.itemCount,t.storedView=t.view,t.view=3;var e="Entry #"+t.selectedItemID,o="Notes #"+t.selectedItemID,n=new Date,r=t.categoryLegend[3];t.selectedItem=new ListObject(t.selectedItemID,e,o,r,n,void 0,void 0)}}function listController(e,t){e.cycleDate=function(e){var o=t.activeDays.indexOf(e);t.dateFilter=t.activeDays[o],t.changeCard(t.dateFilter)},e.selectItem=function(e){console.log("slected itemID: ",e),t.selectedItemID=e}}function notesController(e,t){console.log(t.items),e.selectItem=function(e){console.log("slected itemID: ",e),t.selectedItemID=e}}function editController(e,t,o){e.closeEditor=function(){t.search=!1,t.searchFilter=void 0,t.categoryFilter=void 0,t.selectedItem.text=t.selectedItem.label+t.selectedItem.notes,t.selectedItem.dateContr=(t.selectedItem.date.getMonth()+1<10?"0"+(t.selectedItem.date.getMonth()+1):t.selectedItem.date.getMonth()+1)+"/"+(t.selectedItem.date.getDate()<10?"0"+t.selectedItem.date.getDate():t.selectedItem.date.getDate()),t.addDate(t.selectedItem.dateContr),t.dateFilter=t.selectedItem.dateContr;for(var e=0;e<t.items.length;e++)if(t.items[e].id==t.selectedItemID)return console.log("editing item: ",t.selectedItem),t.items[e]=t.selectedItem,t.view=t.storedView,t.selectedItem=void 0,t.selectedItemID=void 0,void o.post(t.api+"/writedata",t.items);console.log("adding new item: ",t.selectedItem),t.items.push(t.selectedItem),t.view=t.storedView,t.selectedItem=void 0,t.selectedItemID=void 0,o.post(t.api+"/writedata",t.items)}}function navController(e,t){e.calendarPressed=function(){t.view=0},e.listPressed=function(){t.view=1},e.notesPressed=function(){t.view=2}}routeConfig.$inject=["$routeProvider"],myList.config(routeConfig),myList.constant("CATEGORIES",["work","social","home","misc."]),myList.controller("todoController",todoController),todoController.$inject=["$scope","$rootScope","$http","$location","CATEGORIES"],myList.controller("navController",navController),navController.$inject=["$scope","$rootScope"],myList.controller("notesController",notesController),notesController.$inject=["$scope","$rootScope"],myList.controller("editController",editController),editController.$inject=["$scope","$rootScope","$http"],myList.controller("listController",listController),listController.$inject=["$scope","$rootScope"],myList.controller("headerController",headerController),headerController.$inject=["$scope","$rootScope"],myList.controller("addController",addController),addController.$inject=["$scope","$rootScope"];